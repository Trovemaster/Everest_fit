exec awk '
BEGIN{Do_read=0;j1=0}
{

 if ( NF==0 ){next}
 if (substr($1,1,5)=="-----" ){next}

 if ( $1 == "N"   && $2 == "=" ){N=$3;next}
 if ( $1 == "Ref" && $2 == "=" ){Ref=$3;next}
 if ( $1 == "J"   && $2 == "=" ){Jch=$3;next}
 if ( $1 == "Par" && $2 == "=" ){Par=$3;next}


#-----------------------------------------------------------------------------------------------------------
 if ($1 == "I" && $2=="Energy" && $3=="De"){Do_read=1;I1=0;next}
 if ($1 == "I" && $2=="Getting" && $3=="states"){Do_read=0;I1=0;next}
 #
 
 # read states 
 if (Do_read==1 && NF>=16 ){
   j1++;

   Ka = substr($0,42,44)
   Kc = substr($0,46,48)
   v1 = substr($0,51,54)
   v2 = substr($0,55,57)
   v3 = substr($0,58,60)
   Wei= substr($0,63,69)
   Ome= substr($0,72,75)
   Wome=substr($0,78,84)
   Pot= substr($0,86,87)
   Kma= substr($0,89,90)
   Wma= substr($0,93,99)
   ISR= substr($0,101,103)
   N  = substr($0,105,107)

#   800      12624.730    9994.7297454  1  1?199     3  3  2    0.999   1.5    0.749  1  1    0.999   2   1

# 1/2  -1   418   12624.7300    9994.7297   1   1 199  3  3  2 0.999 0.5 0.000  1  1 0.999  2  1 
# 1/2   1     1    2630.0000       0.0000   1   0  1  0  0  0 1.000 0.5 0.000  1  0 1.000  1  0 

#----------------------------------------------------------------------------------------------------------
#     1       2632.006       2.0061017  1  0?  1     0  0  0    0.999   0.5    1.000  1  0    0.999   1   2


   printf " %4s  %2s %5.0f %12.4f %12.4f %3.0f %3.0f %3.0f %2.0f %2.0f %2.0f %5.3f %3.1f %5.3f %2.0f %2.0f %5.3f %2.0f %2.0f \n", \
             Jch,Par,$1,   $2,    $3,     $4,   Ka,  Kc,   v1,   v2,   v3,   Wei,  Ome,  Wom,  Pot,  Kma,  Wma,  ISR,   N    

#      1            2595.458  -33.9009639  1      0?   1     0     0    0     1.000  0.5  1.000  1  0    1.000   1   1
  
 next}
}
END{}
' "$@"

